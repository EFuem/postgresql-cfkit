{% from 'bootstrap/form.html' import render_form, render_field %}

{% extends "base.html" %}
{% block title %}<title>Dataset Upload</title>{% endblock %}

{% block content %}
  <div class="container">
     <div class="jumbotron">
       <h1>ColabFit Dataset Upload</h1>
       <p>If you're going to updload bad data, at least <i>tell</i> us it's bad...</p>
     </div>


  <h2>Basic information</h2>

  <form action="" method="post" class="form" enctype="multipart/form-data" role="form">
    {{ render_field(full_form.name) }}
    {{ render_field(full_form.authors) }}
    {{ render_field(full_form.links) }}
    {{ render_field(full_form.description) }}
    {{ render_field(full_form.elements) }}
    {{ render_field(full_form.data_upload) }}
    {{ render_field(full_form.definitions_upload) }}

    <h2>Property map</h2>

    <br></br>
    <table id="property_map_table" name="property_map_table"
    class="table table-striped">
      <thead>
        <tr>
          <th>Property name</th>
          <th>KIM field</th>
          <th>ASE field</th>
          <th>Units</th>
          <th> </th>
        </tr>
      </thead>
      <tbody>

      </tbody>
    </table>

    <button type="button" class="btn btn-info" onclick="addPropertyMapRow()">
        Add property field<i class="fas fa-plus"></i>
    </button>

    <h2>Property settings</h2>

    <br></br>
    <table id="property_settings_table" class="table table-striped">
      <thead>
        <tr>
          <th>Property name</th>
          <th>Method</th>
          <th>Description</th>
          <th>Labels</th>
          <th>Files</th>
          <th> </th>
        </tr>
      </thead>
      <tbody>

      </tbody>
    </table>

    <button type="button" class="btn btn-info" onclick="addPropertySettingsRow()">
        Add property settings<i class="fas fa-plus"></i>
    </button>

    <h2>Configuration sets</h2>

    <br></br>
    <table id="configuration_sets_table" class="table table-striped">
      <thead>
        <tr>
          <th>Mongo query</th>
          <th>Description</th>
          <th> </th>
        </tr>
      </thead>
      <tbody>

      </tbody>
    </table>

    <button type="button" class="btn btn-info" onclick="addConfigurationSetsRow()">
        Add Row <i class="fas fa-plus"></i>
    </button>

    <h2>Configuration labels</h2>

    <br></br>
    <table id="configuration_labels_table" class="table table-striped">
      <thead>
        <tr>
          <th>Mongo query</th>
          <th>Description</th>
          <th> </th>
        </tr>
      </thead>
      <tbody>

      </tbody>
    </table>

    <button type="button" class="btn btn-info" onclick="addConfigurationLabelsRow()">
        Add Row <i class="fas fa-plus"></i>
    </button>

    <br></br>
    {{ render_field(full_form.submit) }}
  </form>
{%- endblock %}

{% block scripts %}
  <script>
    $(document).ready(function () {
      $('#property_map_table').DataTable();
    });

    // Function to add a row to the Extra Properties Table
    function addPropertyMapRow() {
        let table = document.getElementById("property_map_table");
        let pmc = table.rows.length + 1;
        let row = table.insertRow(-1);
        row.contentEditable = "true";
        let cell0 = row.insertCell(0);
        cell0.innerHTML = "<input type=\"Property name\" name=\"full_form.pmc0_"+pmc.toString()+"\">"
        let cell1 = row.insertCell(1);
        cell1.innerHTML = "<input type=\"KIM field\" name=\"full_form.pmc1_"+pmc.toString()+"\">"
        let cell2 = row.insertCell(2);
        cell2.innerHTML = "<input type=\"ASE field\" name=\"full_form.pmc2_"+pmc.toString()+"\">"
        let cell3 = row.insertCell(3);
        cell3.innerHTML = "<input type=\"Units\" name=\"full_form.pmc3_"+pmc.toString()+"\">"
        let cell4 = row.insertCell(4);
        cell4.innerHTML = "<button type=\"button\" class=\"btn btn-danger\" onclick=\"removePropertyMapRow(this)\"> Remove <i class=\"fas fa-minus\"></i> </button>";
    }

    // Function to remove a row from the extra properties table
    function removePropertyMapRow(x) {
        let i = x.parentNode.parentNode["rowIndex"];
        let table = document.getElementById("property_map_table");
        table.deleteRow(i);
    }

    // Function to add a row to the Extra Properties Table
    function addPropertySettingsRow() {
        let table = document.getElementById("property_settings_table");
        let psc = table.rows.length + 1;
        let row = table.insertRow(-1);
        row.contentEditable = "true";
        let cell0 = row.insertCell(0);
        cell0.innerHTML = "<input type=\"Property name\" name=\"full_form.psc0_"+psc.toString()+"\">";
        let cell1 = row.insertCell(1);
        cell1.innerHTML = "<input type=\"Method\" name=\"full_form.psc1_"+psc.toString()+"\">";
        let cell2 = row.insertCell(2);
        cell2.innerHTML = "<input type=\"Description\" name=\"full_form.psc2_"+psc.toString()+"\">";
        let cell3 = row.insertCell(3);
        cell3.innerHTML = "<input type=\"Labels\" name=\"full_form.psc3_"+psc.toString()+"\">";
        let cell4 = row.insertCell(4);
        cell4.innerHTML = "<input type=\"file\" name=\"full_form.psc4_"+psc.toString()+"\" multiple>";
        let cell = row.insertCell(5);
        cell.innerHTML = "<button type=\"button\" class=\"btn btn-danger\" onclick=\"removePropertySettingsRow(this)\"> Remove <i class=\"fas fa-minus\"></i> </button>";
    }

    // Function to remove a row from the extra properties table
    function removePropertySettingsRow(x) {
        let i = x.parentNode.parentNode["rowIndex"];
        let table = document.getElementById("property_settings_table");
        table.deleteRow(i);
    }

    // Function to add a row to the Extra Properties Table
    function addConfigurationSetsRow() {
        let table = document.getElementById("configuration_sets_table");
        let cs = table.rows.length + 1;
        let row = table.insertRow(-1);
        row.contentEditable = "true";
        let cell0 = row.insertCell(0);
        cell0.innerHTML = "<input type=\"Mongo query\" name=\"full_form.csc0_"+cs.toString()+"\">";
        let cell1 = row.insertCell(1);
        cell1.innerHTML = "<input type=\"Description\" name=\"full_form.csc1_"+cs.toString()+"\">";
        let cell = row.insertCell(5);
        cell.innerHTML = "<button type=\"button\" class=\"btn btn-danger\" onclick=\"removeConfigurationSetsRow(this)\"> Remove <i class=\"fas fa-minus\"></i> </button>";
    }

    // Function to remove a row from the extra properties table
    function removeConfigurationSetsRow(x) {
        let i = x.parentNode.parentNode["rowIndex"];
        let table = document.getElementById("configuration_sets_table");
        table.deleteRow(i);
    }

    // Function to add a row to the Extra Properties Table
    function addConfigurationLabelsRow() {
        let table = document.getElementById("configuration_labels_table");
        let cl = table.rows.length + 1;
        let row = table.insertRow(-1);
        row.contentEditable = "true";
        let cell0 = row.insertCell(0);
        cell0.innerHTML = "<input type=\"Mongo query\" name=\"full_form.clc0_"+cl.toString+"\">";
        let cell1 = row.insertCell(1);
        cell1.innerHTML = "<input type=\"Description\" name=\"full_form.clc1_"+cl.toString+"\">";
        let cell = row.insertCell(5);
        cell.innerHTML = "<button type=\"button\" class=\"btn btn-danger\" onclick=\"removeConfigurationLabelsRow(this)\"> Remove <i class=\"fas fa-minus\"></i> </button>";
    }

    // Function to remove a row from the extra properties table
    function removeConfigurationLabelsRow(x) {
        let i = x.parentNode.parentNode["rowIndex"];
        let table = document.getElementById("configuration_labels_table");
        table.deleteRow(i);
    }


  </script>
{% endblock %}
