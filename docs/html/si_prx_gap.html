<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Si PRX GAP example &mdash; ColabFit Tools Documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
    <link rel="shortcut icon" href="_static/colabfit-logo.png"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Property definitions" href="property_definitions.html" />
    <link rel="prev" title="QM9 example" href="qm9.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> colabfit-tools
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="basic_example.html">Basic example</a></li>
<li class="toctree-l2"><a class="reference internal" href="qm9.html">QM9 example</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Si PRX GAP example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#loading-from-a-file">Loading from a file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cleaning-data">Cleaning data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#handling-different-property-settings">Handling different property settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="#manually-constructed-configurationsets">Manually constructed ConfigurationSets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#manually-applied-configuration-labels">Manually applied Configuration labels</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="property_definitions.html">Property definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="md_file_input.html">Using Markdown files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="classes.html">Classes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">colabfit-tools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="examples.html">Examples</a> &raquo;</li>
      <li>Si PRX GAP example</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/si_prx_gap.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="si-prx-gap-example">
<h1>Si PRX GAP example<a class="headerlink" href="#si-prx-gap-example" title="Permalink to this headline"></a></h1>
<p>This example will be used to highlight some of the more advanced features of the
Dataset class using the popular <a class="reference external" href="https://www.repository.cam.ac.uk/handle/1810/317974">Si GAP dataset</a>.
It is suggested that you go through the <a class="reference internal" href="basic_example.html#basic-example"><span class="std std-ref">basic example</span></a> first. The complete
code will not be shown in this example (for the complete code, see the Jupyter
notebook at <code class="code docutils literal notranslate"><span class="pre">colabfit/examples/Si_PRX_GAP/si_prx_gap.ipynb</span></code>); instead, only the additional features will be
discussed here.</p>
<p>Note that this example assumes that the raw data has already been downloaded
using the following commands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mkdir si_prx_gap
<span class="gp">$ </span><span class="nb">cd</span> si_prx_gap <span class="o">&amp;&amp;</span> wget -O Si_PRX_GAP.zip https://www.repository.cam.ac.uk/bitstream/handle/1810/317974/Si_PRX_GAP.zip?sequence<span class="o">=</span><span class="m">1</span><span class="p">&amp;</span><span class="nv">isAllowed</span><span class="o">=</span>yield
<span class="gp">$ </span><span class="nb">cd</span> si_prx_gap <span class="o">&amp;&amp;</span> unzip Si_PRX_GAP.zip
</pre></div>
</div>
<section id="loading-from-a-file">
<h2>Loading from a file<a class="headerlink" href="#loading-from-a-file" title="Permalink to this headline"></a></h2>
<p>This example uses <a class="reference internal" href="database.html#colabfit.tools.database.load_data" title="colabfit.tools.database.load_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_data()</span></code></a> to load the data
from an existing Extended XYZ file. Note that the raw data includes the
<code class="code docutils literal notranslate"><span class="pre">config_type</span></code> field, which is used to generate the names of the loaded
Configurations. A <code class="xref py py-attr docutils literal notranslate"><span class="pre">default_name</span></code> is also provided to handle the
configurations that do not have a <code class="code docutils literal notranslate"><span class="pre">config_type</span></code> field.
<code class="code docutils literal notranslate"><span class="pre">verbose=True</span></code> is used here since the dataset is large enough to warrant a
progress bar.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">configurations</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span>
        <span class="n">file_path</span><span class="o">=</span><span class="s1">&#39;./si_prx_gap/gp_iter6_sparse9k.xml.xyz&#39;</span><span class="p">,</span>
        <span class="n">file_format</span><span class="o">=</span><span class="s1">&#39;xyz&#39;</span><span class="p">,</span>
        <span class="n">name_field</span><span class="o">=</span><span class="s1">&#39;config_type&#39;</span><span class="p">,</span>  <span class="c1"># key in Configuration.info to use as the Configuration name</span>
        <span class="n">elements</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Si&#39;</span><span class="p">],</span>
        <span class="n">default_name</span><span class="o">=</span><span class="s1">&#39;Si_PRX_GAP&#39;</span><span class="p">,</span>  <span class="c1"># default name with `name_field` not found</span>
        <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="cleaning-data">
<h2>Cleaning data<a class="headerlink" href="#cleaning-data" title="Permalink to this headline"></a></h2>
<p>Some of the Configurations loaded in by <code class="xref py py-meth docutils literal notranslate"><span class="pre">load_data()</span></code> need to be cleaned before they
are ready to be used. Specifically:</p>
<p>1. The <cite>‘per-atom’</cite> field should be added to each configuration
1. Some fields are inconsistently named, using both <cite>‘-’</cite> and <cite>‘_’</cite>
2. Some fields need to be converted from strings to floats
3. Stress vectors should be reshaped to have size <cite>(3, 3)</cite></p>
<p>We will address this by writing a function for modifying the Configurations
in-place.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data stored on atoms needs to be cleaned</span>
<span class="k">def</span> <span class="nf">tform</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="n">img</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;per-atom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Renaming some fields to be consistent</span>
        <span class="n">info_items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">info_items</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;_name&#39;</span><span class="p">,</span> <span class="s1">&#39;_labels&#39;</span><span class="p">,</span> <span class="s1">&#39;_constraints&#39;</span><span class="p">]:</span>
                        <span class="k">continue</span>

                <span class="k">del</span> <span class="n">img</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="n">img</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">v</span>

        <span class="n">arrays_items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">arrays_items</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">img</span><span class="o">.</span><span class="n">arrays</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="n">img</span><span class="o">.</span><span class="n">arrays</span><span class="p">[</span><span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">v</span>

        <span class="c1"># Converting some string values to floats</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="s1">&#39;md-temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;md-cell-t&#39;</span><span class="p">,</span> <span class="s1">&#39;smearing-width&#39;</span><span class="p">,</span> <span class="s1">&#39;md-delta-t&#39;</span><span class="p">,</span>
                <span class="s1">&#39;md-ion-t&#39;</span><span class="p">,</span> <span class="s1">&#39;cut-off-energy&#39;</span><span class="p">,</span> <span class="s1">&#39;elec-energy-tol&#39;</span><span class="p">,</span>
                <span class="p">]:</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">img</span><span class="o">.</span><span class="n">info</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                                <span class="n">img</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="k">except</span><span class="p">:</span>
                                <span class="k">pass</span>

        <span class="c1"># Reshaping shape (9,) stress vector to (3, 3) to match definition</span>
        <span class="k">if</span> <span class="s1">&#39;dft-virial&#39;</span> <span class="ow">in</span> <span class="n">img</span><span class="o">.</span><span class="n">info</span><span class="p">:</span>
                <span class="n">img</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;dft-virial&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;dft-virial&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

        <span class="k">if</span> <span class="s1">&#39;gap-virial&#39;</span> <span class="ow">in</span> <span class="n">img</span><span class="o">.</span><span class="n">info</span><span class="p">:</span>
                        <span class="n">img</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;gap-virial&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;gap-virial&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">tform()</span></code> function can be passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_data()</span></code> using the
<code class="code docutils literal notranslate"><span class="pre">transform</span></code> argument, which will call <code class="xref py py-meth docutils literal notranslate"><span class="pre">tform()</span></code> on each Configuration
before doing any additional processing.</p>
</section>
<section id="handling-different-property-settings">
<h2>Handling different property settings<a class="headerlink" href="#handling-different-property-settings" title="Permalink to this headline"></a></h2>
<p>This Dataset contains the common energy/forces/virial data, but also includes a
large amount of additional data/information for each calculation which can be
stored as PropertySettings objects. This Dataset also has energy/forces/virial
data computed using multiple methods (DFT and a trained GAP model). In this
section we will discuss how to use the <code class="code docutils literal notranslate"><span class="pre">property_map</span></code> argument property
with the <code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_data()</span></code> function.</p>
<p>To begin with, we first write a property definition for storing computed
energy/forces/virial data. Note that this same definition will be used for both
the DFT-computed and the GAP-computed data.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">base_definition</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;property-id&#39;</span><span class="p">:</span> <span class="s1">&#39;energy-forces-stress&#39;</span><span class="p">,</span>
        <span class="s1">&#39;property-title&#39;</span><span class="p">:</span> <span class="s1">&#39;Basic outputs from a static calculation&#39;</span><span class="p">,</span>
        <span class="s1">&#39;property-description&#39;</span><span class="p">:</span>
                <span class="s1">&#39;Energy, forces, and stresses from a calculation of a &#39;</span>\
                <span class="s1">&#39;static configuration. Energies must be specified to be &#39;</span>\
                <span class="s1">&#39;per-atom or supercell. If a reference energy has been &#39;</span>\
                <span class="s1">&#39;used, this must be specified as well.&#39;</span><span class="p">,</span>

        <span class="s1">&#39;energy&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span>
                <span class="s1">&#39;has-unit&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s1">&#39;extent&#39;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="s1">&#39;required&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span>
                        <span class="s1">&#39;The potential energy of the system.&#39;</span>
        <span class="p">},</span>
        <span class="s1">&#39;forces&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span>
                <span class="s1">&#39;has-unit&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s1">&#39;extent&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                <span class="s1">&#39;required&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span>
                        <span class="s1">&#39;The [x,y,z] components of the force on each particle.&#39;</span>
        <span class="p">},</span>
        <span class="s1">&#39;stress&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span>
                <span class="s1">&#39;has-unit&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s1">&#39;extent&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                <span class="s1">&#39;required&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span>
                        <span class="s1">&#39;The full Cauchy stress tensor of the simulation cell&#39;</span>
        <span class="p">},</span>

        <span class="s1">&#39;per-atom&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span><span class="p">,</span>
                <span class="s1">&#39;has-unit&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;extent&#39;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="s1">&#39;required&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span>
                        <span class="s1">&#39;If True, &quot;energy&quot; is the total energy of the system, &#39;</span>\
                        <span class="s1">&#39;and has NOT been divided by the number of atoms in the &#39;</span>\
                        <span class="s1">&#39;configuration.&#39;</span>
        <span class="p">},</span>
        <span class="s1">&#39;reference-energy&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span>
                <span class="s1">&#39;has-unit&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s1">&#39;extent&#39;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="s1">&#39;required&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span>
                        <span class="s1">&#39;If provided, then &quot;energy&quot; is the energy (either of &#39;</span>\
                        <span class="s1">&#39;the whole system, or per-atom) LESS the energy of &#39;</span>\
                        <span class="s1">&#39;a reference configuration (E = E_0 - E_reference). &#39;</span>\
                        <span class="s1">&#39;Note that &quot;reference-energy&quot; is just provided for &#39;</span>\
                        <span class="s1">&#39;documentation, and that &quot;energy&quot; should already have &#39;</span>\
                        <span class="s1">&#39;this value subtracted off. The reference energy must &#39;</span>\
                        <span class="s1">&#39;have the same units as &quot;energy&quot;.&#39;</span>
        <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We will then prepare two separate maps. One for loading any DFT-computed
properties:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dft_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1"># Property Definition field: {&#39;field&#39;: ASE field, &#39;units&#39;: ASE-readable units}</span>
        <span class="s1">&#39;energy&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;field&#39;</span><span class="p">:</span> <span class="s1">&#39;dft-energy&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;eV&#39;</span><span class="p">},</span>
        <span class="s1">&#39;forces&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;field&#39;</span><span class="p">:</span> <span class="s1">&#39;dft-force&#39;</span><span class="p">,</span>  <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;eV/Ang&#39;</span><span class="p">},</span>
        <span class="s1">&#39;stress&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;field&#39;</span><span class="p">:</span> <span class="s1">&#39;dft-virial&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;GPa&#39;</span><span class="p">},</span>
        <span class="s1">&#39;per-atom&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;field&#39;</span><span class="p">:</span> <span class="s1">&#39;per-atom&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>And a separate one for loading GAP-computed properties:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gap_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1"># Property Definition field: {&#39;field&#39;: ASE field, &#39;units&#39;: ASE-readable units}</span>
        <span class="s1">&#39;energy&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;field&#39;</span><span class="p">:</span> <span class="s1">&#39;gap-energy&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;eV&#39;</span><span class="p">},</span>
        <span class="s1">&#39;forces&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;field&#39;</span><span class="p">:</span> <span class="s1">&#39;gap-force&#39;</span><span class="p">,</span>  <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;eV/Ang&#39;</span><span class="p">},</span>
        <span class="s1">&#39;stress&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;field&#39;</span><span class="p">:</span> <span class="s1">&#39;gap-virial&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;GPa&#39;</span><span class="p">},</span>
        <span class="s1">&#39;per-atom&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;field&#39;</span><span class="p">:</span> <span class="s1">&#39;per-atom&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Next, we will create a list of all of the fields that should be stored on a
PropertySettings object rather than on a Property:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">settings_keys</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;mix-history-length&#39;</span><span class="p">,</span>
        <span class="s1">&#39;castep-file-name&#39;</span><span class="p">,</span>
        <span class="s1">&#39;grid-scale&#39;</span><span class="p">,</span>
        <span class="s1">&#39;popn-calculate&#39;</span><span class="p">,</span>
        <span class="s1">&#39;n-neighb&#39;</span><span class="p">,</span>
        <span class="s1">&#39;oldpos&#39;</span><span class="p">,</span>
        <span class="s1">&#39;i-step&#39;</span><span class="p">,</span>
        <span class="s1">&#39;md-temperature&#39;</span><span class="p">,</span>
        <span class="s1">&#39;positions&#39;</span><span class="p">,</span>
        <span class="s1">&#39;task&#39;</span><span class="p">,</span>
        <span class="s1">&#39;data-distribution&#39;</span><span class="p">,</span>
        <span class="s1">&#39;avg-ke&#39;</span><span class="p">,</span>
        <span class="s1">&#39;force-nlpot&#39;</span><span class="p">,</span>
        <span class="s1">&#39;continuation&#39;</span><span class="p">,</span>
        <span class="s1">&#39;castep-run-time&#39;</span><span class="p">,</span>
        <span class="s1">&#39;calculate-stress&#39;</span><span class="p">,</span>
        <span class="s1">&#39;minim-hydrostatic-strain&#39;</span><span class="p">,</span>
        <span class="s1">&#39;avgpos&#39;</span><span class="p">,</span>
        <span class="s1">&#39;frac-pos&#39;</span><span class="p">,</span>
        <span class="s1">&#39;hamiltonian&#39;</span><span class="p">,</span>
        <span class="s1">&#39;md-cell-t&#39;</span><span class="p">,</span>
        <span class="s1">&#39;cutoff-factor&#39;</span><span class="p">,</span>
        <span class="s1">&#39;momenta&#39;</span><span class="p">,</span>
        <span class="s1">&#39;elec-energy-tol&#39;</span><span class="p">,</span>
        <span class="s1">&#39;mixing-scheme&#39;</span><span class="p">,</span>
        <span class="s1">&#39;minim-lattice-fix&#39;</span><span class="p">,</span>
        <span class="s1">&#39;in-file&#39;</span><span class="p">,</span>
        <span class="s1">&#39;travel&#39;</span><span class="p">,</span>
        <span class="s1">&#39;thermostat-region&#39;</span><span class="p">,</span>
        <span class="s1">&#39;time&#39;</span><span class="p">,</span>
        <span class="s1">&#39;temperature&#39;</span><span class="p">,</span>
        <span class="s1">&#39;kpoints-mp-grid&#39;</span><span class="p">,</span>
        <span class="s1">&#39;cutoff&#39;</span><span class="p">,</span>
        <span class="s1">&#39;xc-functional&#39;</span><span class="p">,</span>
        <span class="s1">&#39;smearing-width&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pressure&#39;</span><span class="p">,</span>
        <span class="s1">&#39;reuse&#39;</span><span class="p">,</span>
        <span class="s1">&#39;fix-occupancy&#39;</span><span class="p">,</span>
        <span class="s1">&#39;map-shift&#39;</span><span class="p">,</span>
        <span class="s1">&#39;md-num-iter&#39;</span><span class="p">,</span>
        <span class="s1">&#39;damp-mask&#39;</span><span class="p">,</span>
        <span class="s1">&#39;opt-strategy&#39;</span><span class="p">,</span>
        <span class="s1">&#39;spin-polarized&#39;</span><span class="p">,</span>
        <span class="s1">&#39;nextra-bands&#39;</span><span class="p">,</span>
        <span class="s1">&#39;fine-grid-scale&#39;</span><span class="p">,</span>
        <span class="s1">&#39;masses&#39;</span><span class="p">,</span>
        <span class="s1">&#39;iprint&#39;</span><span class="p">,</span>
        <span class="s1">&#39;finite-basis-corr&#39;</span><span class="p">,</span>
        <span class="s1">&#39;enthalpy&#39;</span><span class="p">,</span>
        <span class="s1">&#39;opt-strategy-bias&#39;</span><span class="p">,</span>
        <span class="s1">&#39;force-ewald&#39;</span><span class="p">,</span>
        <span class="s1">&#39;num-dump-cycles&#39;</span><span class="p">,</span>
        <span class="s1">&#39;velo&#39;</span><span class="p">,</span>
        <span class="s1">&#39;md-delta-t&#39;</span><span class="p">,</span>
        <span class="s1">&#39;md-ion-t&#39;</span><span class="p">,</span>
        <span class="s1">&#39;force-locpot&#39;</span><span class="p">,</span>
        <span class="s1">&#39;numbers&#39;</span><span class="p">,</span>
        <span class="s1">&#39;max-scf-cycles&#39;</span><span class="p">,</span>
        <span class="s1">&#39;mass&#39;</span><span class="p">,</span>
        <span class="s1">&#39;minim-constant-volume&#39;</span><span class="p">,</span>
        <span class="s1">&#39;cut-off-energy&#39;</span><span class="p">,</span>
        <span class="s1">&#39;virial&#39;</span><span class="p">,</span>
        <span class="s1">&#39;nneightol&#39;</span><span class="p">,</span>
        <span class="s1">&#39;max-charge-amp&#39;</span><span class="p">,</span>
        <span class="s1">&#39;md-thermostat&#39;</span><span class="p">,</span>
        <span class="s1">&#39;md-ensemble&#39;</span><span class="p">,</span>
        <span class="s1">&#39;acc&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
<p>We will also specify any units on the fields:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">units</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;energy&#39;</span><span class="p">:</span> <span class="s1">&#39;eV&#39;</span><span class="p">,</span>
        <span class="s1">&#39;forces&#39;</span><span class="p">:</span> <span class="s1">&#39;eV/Ang&#39;</span><span class="p">,</span>
        <span class="s1">&#39;virial&#39;</span><span class="p">:</span> <span class="s1">&#39;GPa&#39;</span><span class="p">,</span>
        <span class="s1">&#39;oldpos&#39;</span><span class="p">:</span> <span class="s1">&#39;Ang&#39;</span><span class="p">,</span>
        <span class="s1">&#39;md-temperature&#39;</span><span class="p">:</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span>
        <span class="s1">&#39;positions&#39;</span><span class="p">:</span> <span class="s1">&#39;Ang&#39;</span><span class="p">,</span>
        <span class="s1">&#39;avg-ke&#39;</span><span class="p">:</span> <span class="s1">&#39;eV&#39;</span><span class="p">,</span>
        <span class="s1">&#39;force-nlpot&#39;</span><span class="p">:</span> <span class="s1">&#39;eV/Ang&#39;</span><span class="p">,</span>
        <span class="s1">&#39;castep-run-time&#39;</span><span class="p">:</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span>
        <span class="s1">&#39;avgpos&#39;</span><span class="p">:</span> <span class="s1">&#39;Ang&#39;</span><span class="p">,</span>
        <span class="s1">&#39;md-cell-t&#39;</span><span class="p">:</span> <span class="s1">&#39;ps&#39;</span><span class="p">,</span>
        <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span>
        <span class="s1">&#39;temperature&#39;</span><span class="p">:</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span>
        <span class="s1">&#39;gap-force&#39;</span><span class="p">:</span> <span class="s1">&#39;eV/Ang&#39;</span><span class="p">,</span>
        <span class="s1">&#39;gap-energy&#39;</span><span class="p">:</span> <span class="s1">&#39;eV&#39;</span><span class="p">,</span>
        <span class="s1">&#39;cutoff&#39;</span><span class="p">:</span> <span class="s1">&#39;Ang&#39;</span><span class="p">,</span>
        <span class="s1">&#39;smearing-width&#39;</span><span class="p">:</span> <span class="s1">&#39;eV&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pressure&#39;</span><span class="p">:</span> <span class="s1">&#39;GPa&#39;</span><span class="p">,</span>
        <span class="s1">&#39;gap-virial&#39;</span><span class="p">:</span> <span class="s1">&#39;GPa&#39;</span><span class="p">,</span>
        <span class="s1">&#39;masses&#39;</span><span class="p">:</span> <span class="s1">&#39;_amu&#39;</span><span class="p">,</span>
        <span class="s1">&#39;enthalpy&#39;</span><span class="p">:</span> <span class="s1">&#39;eV&#39;</span><span class="p">,</span>
        <span class="s1">&#39;force-ewald&#39;</span><span class="p">:</span> <span class="s1">&#39;eV/Ang&#39;</span><span class="p">,</span>
        <span class="s1">&#39;velo&#39;</span><span class="p">:</span> <span class="s1">&#39;Ang/s&#39;</span><span class="p">,</span>
        <span class="s1">&#39;md-delta-t&#39;</span><span class="p">:</span> <span class="s1">&#39;fs&#39;</span><span class="p">,</span>
        <span class="s1">&#39;md-ion-t&#39;</span><span class="p">:</span> <span class="s1">&#39;ps&#39;</span><span class="p">,</span>
        <span class="s1">&#39;force-locpot&#39;</span><span class="p">:</span> <span class="s1">&#39;eV/Ang&#39;</span><span class="p">,</span>
        <span class="s1">&#39;mass&#39;</span><span class="p">:</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span>
        <span class="s1">&#39;cut-off-energy&#39;</span><span class="p">:</span> <span class="s1">&#39;eV&#39;</span><span class="p">,</span>
        <span class="s1">&#39;virial&#39;</span><span class="p">:</span> <span class="s1">&#39;GPa&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We will also create dictionaries for constructing the DFT settings:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dft_settings_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">k</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;field&#39;</span><span class="p">:</span> <span class="n">k</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="n">units</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">units</span> <span class="k">else</span> <span class="kc">None</span><span class="p">}</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">settings_keys</span>
<span class="p">}</span>

<span class="n">dft_settings_map</span><span class="p">[</span><span class="s1">&#39;_method&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;CASTEP&#39;</span>
<span class="n">dft_settings_map</span><span class="p">[</span><span class="s1">&#39;_description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;DFT calculations using the CASTEP software&#39;</span>
<span class="n">dft_settings_map</span><span class="p">[</span><span class="s1">&#39;_files&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">dft_settings_map</span><span class="p">[</span><span class="s1">&#39;_labels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Monkhorst-Pack&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>And the GAP settings:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gap_settings_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dft_settings_map</span><span class="p">)</span>

<span class="n">gap_settings_map</span><span class="p">[</span><span class="s1">&#39;_method&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;GAP&#39;</span>
<span class="n">gap_settings_map</span><span class="p">[</span><span class="s1">&#39;_description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Predictions using a trained GAP potential&#39;</span>
<span class="n">gap_settings_map</span><span class="p">[</span><span class="s1">&#39;_files&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">gap_settings_map</span><span class="p">[</span><span class="s1">&#39;_labels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GAP&#39;</span><span class="p">,</span> <span class="s1">&#39;classical&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Each of these settings maps will be attached to their corresponding property
maps:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dft_map</span><span class="p">[</span><span class="s1">&#39;_settings&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dft_settings_map</span>
<span class="n">gap_map</span><span class="p">[</span><span class="s1">&#39;_settings&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gap_settings_map</span>
</pre></div>
</div>
<p>Finally, they will both be merged into a single map, which will be passed
directly to <code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_data()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">property_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;energy-forces-stress&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">dft_map</span><span class="p">,</span>
                <span class="n">gap_map</span><span class="p">,</span>
        <span class="p">]</span>
<span class="p">}</span>

<span class="n">ids</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">insert_data</span><span class="p">(</span>
        <span class="n">images</span><span class="p">,</span>
        <span class="n">property_map</span><span class="o">=</span><span class="n">property_map</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">tform</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="manually-constructed-configurationsets">
<h2>Manually constructed ConfigurationSets<a class="headerlink" href="#manually-constructed-configurationsets" title="Permalink to this headline"></a></h2>
<p>Since this dataset was manually constructed by its authors, a large amount of
additional information has been provided to better identify the Configurations
(see Table I. in <a class="reference external" href="https://journals.aps.org/prx/abstract/10.1103/PhysRevX.8.041048">the original paper</a>).
In order to retain this information, we define ConfigurationSets by regex
matching on the Configuration names (see
<a class="reference internal" href="usage.html#building-configuration-sets"><span class="std std-ref">Building configuration sets</span></a> for more details).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">configuration_set_regexes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;isolated_atom&#39;</span><span class="p">:</span> <span class="s1">&#39;Reference atom&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bt&#39;</span><span class="p">:</span> <span class="s1">&#39;Beta-tin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;dia&#39;</span><span class="p">:</span> <span class="s1">&#39;Diamond&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sh&#39;</span><span class="p">:</span> <span class="s1">&#39;Simple hexagonal&#39;</span><span class="p">,</span>
    <span class="s1">&#39;hex_diamond&#39;</span><span class="p">:</span> <span class="s1">&#39;Hexagonal diamond&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bcc&#39;</span><span class="p">:</span> <span class="s1">&#39;Body-centered-cubic&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bc8&#39;</span><span class="p">:</span> <span class="s1">&#39;BC8&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fcc&#39;</span><span class="p">:</span> <span class="s1">&#39;Face-centered-cubic&#39;</span><span class="p">,</span>
    <span class="s1">&#39;hcp&#39;</span><span class="p">:</span> <span class="s1">&#39;Hexagonal-close-packed&#39;</span><span class="p">,</span>
    <span class="s1">&#39;st12&#39;</span><span class="p">:</span> <span class="s1">&#39;ST12&#39;</span><span class="p">,</span>
    <span class="s1">&#39;liq&#39;</span><span class="p">:</span> <span class="s1">&#39;Liquid&#39;</span><span class="p">,</span>
    <span class="s1">&#39;amorph&#39;</span><span class="p">:</span> <span class="s1">&#39;Amorphous&#39;</span><span class="p">,</span>
    <span class="s1">&#39;surface_001&#39;</span><span class="p">:</span> <span class="s1">&#39;Diamond surface (001)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;surface_110&#39;</span><span class="p">:</span> <span class="s1">&#39;Diamond surface (110)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;surface_111&#39;</span><span class="p">:</span> <span class="s1">&#39;Diamond surface (111)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;surface_111_pandey&#39;</span><span class="p">:</span> <span class="s1">&#39;Pandey reconstruction of diamond (111) surface&#39;</span><span class="p">,</span>
    <span class="s1">&#39;surface_111_3x3_das&#39;</span><span class="p">:</span> <span class="s1">&#39;Dimer-adatom-stacking-fault (DAS) reconstruction&#39;</span><span class="p">,</span>
    <span class="s1">&#39;111adatom&#39;</span><span class="p">:</span> <span class="s1">&#39;Configurations with adatom on (111) surface&#39;</span><span class="p">,</span>
    <span class="s1">&#39;crack_110_1-10&#39;</span><span class="p">:</span> <span class="s1">&#39;Small (110) crack tip&#39;</span><span class="p">,</span>
    <span class="s1">&#39;crack_111_1-10&#39;</span><span class="p">:</span> <span class="s1">&#39;Small (111) crack tip&#39;</span><span class="p">,</span>
    <span class="s1">&#39;decohesion&#39;</span><span class="p">:</span> <span class="s1">&#39;Decohesion of diamond-structure Si along various directions&#39;</span><span class="p">,</span>
    <span class="s1">&#39;divacancy&#39;</span><span class="p">:</span> <span class="s1">&#39;Diamond divacancy configurations&#39;</span><span class="p">,</span>
    <span class="s1">&#39;interstitial&#39;</span><span class="p">:</span> <span class="s1">&#39;Diamond interstitial configurations&#39;</span><span class="p">,</span>
    <span class="s1">&#39;screw_disloc&#39;</span><span class="p">:</span> <span class="s1">&#39;Si screw dislocation core&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sp&#39;</span><span class="p">:</span> <span class="s1">&#39;sp bonded configurations&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sp2&#39;</span><span class="p">:</span> <span class="s1">&#39;sp2 bonded configurations&#39;</span><span class="p">,</span>
    <span class="s1">&#39;vacancy&#39;</span><span class="p">:</span> <span class="s1">&#39;Diamond vacancy configurations&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cs_ids</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">regex</span><span class="p">,</span> <span class="n">desc</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">configuration_set_regexes</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
        <span class="n">co_ids</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span>
                <span class="s1">&#39;configurations&#39;</span><span class="p">,</span>
                <span class="n">fields</span><span class="o">=</span><span class="s1">&#39;_id&#39;</span><span class="p">,</span>
                <span class="n">query</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;names&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$regex&#39;</span><span class="p">:</span> <span class="n">regex</span><span class="p">}},</span>
                <span class="n">ravel</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Configuration set </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="n">regex</span><span class="si">}</span><span class="s1">):&#39;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">22</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">co_ids</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>

        <span class="n">cs_id</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">insert_configuration_set</span><span class="p">(</span><span class="n">co_ids</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="n">desc</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">cs_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cs_id</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="manually-applied-configuration-labels">
<h2>Manually applied Configuration labels<a class="headerlink" href="#manually-applied-configuration-labels" title="Permalink to this headline"></a></h2>
<p>Similarly, additional knowledge provided by the authors about the types of
Configurations and Properties in the dataset can be used to apply metadata
labels to the Configurations, which is useful for enabling querying over the
data by future users. See <a class="reference internal" href="usage.html#applying-configuration-labels"><span class="std std-ref">Applying configuration labels</span></a> for more details.</p>
<p>Second, applying labels to the Configurations based on author-provided
information.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">configuration_label_regexes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;isolated_atom&#39;</span><span class="p">:</span> <span class="s1">&#39;isolated_atom&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bt&#39;</span><span class="p">:</span> <span class="s1">&#39;a5&#39;</span><span class="p">,</span>
    <span class="s1">&#39;dia&#39;</span><span class="p">:</span> <span class="s1">&#39;diamond&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sh&#39;</span><span class="p">:</span> <span class="s1">&#39;sh&#39;</span><span class="p">,</span>
    <span class="s1">&#39;hex_diamond&#39;</span><span class="p">:</span> <span class="s1">&#39;sonsdaleite&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bcc&#39;</span><span class="p">:</span> <span class="s1">&#39;bcc&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bc8&#39;</span><span class="p">:</span> <span class="s1">&#39;bc8&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fcc&#39;</span><span class="p">:</span> <span class="s1">&#39;fcc&#39;</span><span class="p">,</span>
    <span class="s1">&#39;hcp&#39;</span><span class="p">:</span> <span class="s1">&#39;hcp&#39;</span><span class="p">,</span>
    <span class="s1">&#39;st12&#39;</span><span class="p">:</span> <span class="s1">&#39;st12&#39;</span><span class="p">,</span>
    <span class="s1">&#39;liq&#39;</span><span class="p">:</span> <span class="s1">&#39;liquid&#39;</span><span class="p">,</span>
    <span class="s1">&#39;amorph&#39;</span><span class="p">:</span> <span class="s1">&#39;amorphous&#39;</span><span class="p">,</span>
    <span class="s1">&#39;surface_001&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">,</span> <span class="s1">&#39;001&#39;</span><span class="p">],</span>
    <span class="s1">&#39;surface_110&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">,</span> <span class="s1">&#39;110&#39;</span><span class="p">],</span>
    <span class="s1">&#39;surface_111&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">,</span> <span class="s1">&#39;111&#39;</span><span class="p">],</span>
    <span class="s1">&#39;surface_111_pandey&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">,</span> <span class="s1">&#39;111&#39;</span><span class="p">],</span>
    <span class="s1">&#39;surface_111_3x3_das&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">,</span> <span class="s1">&#39;111&#39;</span><span class="p">,</span> <span class="s1">&#39;das&#39;</span><span class="p">],</span>
    <span class="s1">&#39;111adatom&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">,</span> <span class="s1">&#39;111&#39;</span><span class="p">,</span> <span class="s1">&#39;adatom&#39;</span><span class="p">],</span>
    <span class="s1">&#39;crack_110_1-10&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;crack&#39;</span><span class="p">,</span> <span class="s1">&#39;110&#39;</span><span class="p">],</span>
    <span class="s1">&#39;crack_111_1-10&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;crac&#39;</span><span class="p">,</span> <span class="s1">&#39;111&#39;</span><span class="p">],</span>
    <span class="s1">&#39;decohesion&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;diamond&#39;</span><span class="p">,</span> <span class="s1">&#39;decohesion&#39;</span><span class="p">],</span>
    <span class="s1">&#39;divacancy&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;diamond&#39;</span><span class="p">,</span> <span class="s1">&#39;vacancy&#39;</span><span class="p">,</span> <span class="s1">&#39;divacancy&#39;</span><span class="p">],</span>
    <span class="s1">&#39;interstitial&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;diamond&#39;</span><span class="p">,</span> <span class="s1">&#39;interstitial&#39;</span><span class="p">],</span>
    <span class="s1">&#39;screw_disloc&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;screw&#39;</span><span class="p">,</span> <span class="s1">&#39;dislocation&#39;</span><span class="p">],</span>
    <span class="s1">&#39;sp&#39;</span><span class="p">:</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sp2&#39;</span><span class="p">:</span> <span class="s1">&#39;sp2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;vacancy&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;diamond&#39;</span><span class="p">,</span> <span class="s1">&#39;vacancy&#39;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">regex</span><span class="p">,</span> <span class="n">labels</span> <span class="ow">in</span> <span class="n">configuration_label_regexes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">client</span><span class="o">.</span><span class="n">apply_labels</span><span class="p">(</span>
        <span class="n">dataset_id</span><span class="o">=</span><span class="n">ds_id</span><span class="p">,</span>
        <span class="n">collection_name</span><span class="o">=</span><span class="s1">&#39;configurations&#39;</span><span class="p">,</span>
        <span class="n">query</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;names&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$regex&#39;</span><span class="p">:</span> <span class="n">regex</span><span class="p">}},</span>
        <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="qm9.html" class="btn btn-neutral float-left" title="QM9 example" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="property_definitions.html" class="btn btn-neutral float-right" title="Property definitions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, ColabFit.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>